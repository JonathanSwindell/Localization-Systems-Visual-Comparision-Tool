"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("papaparse"),t=require("react");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e),o=r(t),a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}function c(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return e.some((function(e){return!c(t)&&e&&e.apply(void 0,u([t],r)),c(t)}))}}function s(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}var f=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(t)}};function d(e,t){var r="application/x-moz-file"===e.type||function(e,t){if(e&&t){var r=Array.isArray(t)?t:t.split(","),n=e.name||"",o=(e.type||"").toLowerCase(),a=o.replace(/\/.*$/,"");return r.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?n.toLowerCase().endsWith(t):t.endsWith("/*")?a===t.replace(/\/.*$/,""):o===t}))}return!0}(e,t);return[r,r?null:f(t)]}function p(e){return null!=e}var v=function(e){return{code:"file-too-large",message:"File is larger than ".concat(e," bytes")}},g=function(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," bytes")}},m={code:"too-many-files",message:"Too many files"};function y(e){e.preventDefault()}function h(e,t){return n.default.parse(e,t)}function D(e,t){n.default.parse(e,Object.assign({},{download:!0},t))}function b(e,t){return void 0===t&&(t={}),n.default.unparse(e,t)}var F={Link:"link",Button:"button"};var E={progressBar:{borderRadius:3,boxShadow:"inset 0 1px 3px rgba(0, 0, 0, .2)",bottom:14,width:"100%"},button:{position:"inherit",width:"100%"},fill:{backgroundColor:"#659cef",borderRadius:3,height:10,transition:"width 500ms ease-in-out"}};function w(e){var r=e.style,n=e.className,a=e.display,i=t.useState(0),u=i[0],c=i[1];return t.useEffect((function(){c(e.percentage)}),[e.percentage]),o.default.createElement("span",{style:Object.assign({},E.progressBar,E.fill,r,{width:"".concat(u,"%"),display:a}),className:n})}function C(e){var t=e.color,r=e.width,n=void 0===r?23:r,a=e.height,i=void 0===a?23:a;return o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:i,viewBox:"0 0 512 512"},o.default.createElement("path",{fill:t,d:"M504.1 256C504.1 119 393 7.9 256 7.9S7.9 119 7.9 256 119 504.1 256 504.1 504.1 393 504.1 256z"}),o.default.createElement("path",{fill:"#FFF",d:"M285 256l72.5-84.2c7.9-9.2 6.9-23-2.3-31-9.2-7.9-23-6.9-30.9 2.3L256 222.4l-68.2-79.2c-7.9-9.2-21.8-10.2-31-2.3-9.2 7.9-10.2 21.8-2.3 31L227 256l-72.5 84.2c-7.9 9.2-6.9 23 2.3 31 4.1 3.6 9.2 5.3 14.3 5.3 6.2 0 12.3-2.6 16.6-7.6l68.2-79.2 68.2 79.2c4.3 5 10.5 7.6 16.6 7.6 5.1 0 10.2-1.7 14.3-5.3 9.2-7.9 10.2-21.8 2.3-31L285 256z"}))}function P(){var e=function(e){var r=e.children,f=e.accept,h=void 0===f?"text/csv, .csv, application/vnd.ms-excel":f,D=e.config,b=void 0===D?{}:D,F=e.minSize,E=void 0===F?0:F,P=e.maxSize,k=void 0===P?1/0:P,S=e.maxFiles,O=void 0===S?1:S,R=e.disabled,A=void 0!==R&&R,L=e.noClick,T=void 0!==L&&L,j=e.noDrag,z=void 0!==j&&j,M=e.noDragEventsBubbling,I=void 0!==M&&M,_=e.noKeyboard,K=void 0!==_&&_,N=e.multiple,U=void 0!==N&&N,V=e.required,q=void 0!==V&&V,W=e.preventDropOnDocument,$=void 0===W||W,G=e.onUploadAccepted,H=e.validator,J=e.onUploadRejected,Q=e.onDragEnter,X=e.onDragOver,Y=e.onDragLeave,Z=t.useRef(null),ee=t.useRef(null),te=t.useRef([]),re=t.useReducer(B,x),ne=re[0],oe=re[1],ae=ne.acceptedFile,ie=ne.displayProgressBar,ue=ne.progressBarPercentage,ce=ne.draggedFiles,le=ne.isFileDialogActive,se=function(e){ee.current&&ee.current.contains(e.target)||(e.preventDefault(),te.current=[])};t.useEffect((function(){return $&&(document.addEventListener("dragover",y,!1),document.addEventListener("drop",se,!1)),function(){$&&(document.removeEventListener("dragover",y),document.removeEventListener("drop",se))}}),[ee,$]);var fe=function(e){return A?null:e},de=function(e){return z?null:fe(e)},pe=function(e){I&&e.stopPropagation()},ve=function(e){e.preventDefault(e),e.persist(),pe(e)},ge=function(e){oe({displayProgressBar:e,type:"setDisplayProgressBar"})},me=function(e){oe({progressBarPercentage:e,type:"setProgressBarPercentage"})},ye=function(e){return o.default.createElement(w,a({display:ie,percentage:ue},e))},he=function(e){return o.default.createElement(C,a({},e))},De=t.useCallback((function(){Z.current&&ne.displayProgressBar&&(oe({type:"openDialog"}),Z.current.value=null,Z.current.click())}),[oe]),be=function(){le&&setTimeout((function(){Z.current&&(Z.current.files.length||oe({type:"closeDialog"}))}),300)};t.useEffect((function(){return window.addEventListener("focus",be,!1),function(){window.removeEventListener("focus",be,!1)}}),[Z,le]);var Fe=t.useCallback((function(){var e;T||(void 0===e&&(e=window.navigator.userAgent),function(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function(e){return-1!==e.indexOf("Edge/")}(e)?setTimeout(De,0):De())}),[Z,T]),Ee=t.useCallback((function(e){if(ve(e),me(0),te.current=[],s(e)){if(c(e)&&!I)return;var t=[],r=[],o=e.target.files||e.dataTransfer&&e.dataTransfer.files;if(Array.from(o).forEach((function(e){var n=d(e,h),o=n[0],a=n[1],i=function(e,t,r){if(p(e.size))if(p(t)&&p(r)){if(e.size>r)return[!1,v(r)];if(e.size<t)return[!1,g(t)]}else{if(p(t)&&e.size<t)return[!1,g(t)];if(p(r)&&e.size>r)return[!1,v(r)]}return[!0,null]}(e,E,k),u=i[0],c=i[1],l=H?H(e):null;if(o&&u&&!l)t.push(e);else{var s=[a,c];l&&(s=s.concat(l)),r.push({file:e,errors:s.filter((function(e){return e}))})}})),(!U&&t.length>1||U&&O>=1&&t.length>O)&&(t.forEach((function(e){r.push({file:e,errors:[m]})})),t.splice(0)),oe({acceptedFiles:t,fileRejections:r,type:"setFiles"}),ge("block"),r.length>0&&J&&J(r,e),t.length>0&&G){var a={},i=[],u=[],l=[],f=new window.FileReader,y=0;t.forEach((function(e){oe({acceptedFile:e,type:"setFile"}),a={complete:(null==b?void 0:b.complete)||(null==b?void 0:b.step)?b.complete:function(){G({data:i,errors:u,meta:l},e)},step:(null==b?void 0:b.step)?b.step:function(t){if(i.push(t.data),t.errors.length>0&&u.push(t.errors),t.length>0&&l.push(t[0].meta),b&&b.preview){if(y=Math.round(i.length/b.preview*100),i.length===b.preview)G({data:i,errors:u,meta:l},e)}else{var r=t.meta.cursor,n=Math.round(r/e.size*100);if(n===y)return;y=n}me(y)}},a=Object.assign({},b,a),f.onload=function(e){n.default.parse(e.target.result,a)},f.onloadend=function(){setTimeout((function(){ge("none")}),2e3)},f.readAsText(e,b.encoding||"utf-8")}))}}}),[U,h,E,k,O,H,G]),we=t.useCallback((function(e){pe(e)}),[]),Ce=function(e){return K?null:fe(e)},Pe=t.useCallback((function(e){if(ve(e),te.current=u(u([],te.current),[e.target]),s(e)){if(c(e)&&!I)return;oe({draggedFiles:ce,isDragActive:!0,type:"setDraggedFiles"}),Q&&Q(e)}}),[Q,I]),xe=t.useCallback((function(e){ve(e);var t=s(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(e){}return t&&X&&X(e),!1}),[X,I]),Be=t.useCallback((function(e){ve(e);var t=te.current.filter((function(e){return ee.current&&ee.current.contains(e)})),r=t.indexOf(e.target);-1!==r&&t.splice(r,1),te.current=t,t.length>0||(oe({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),s(e)&&Y&&Y(e))}),[ee,Y,I]),ke=t.useCallback((function(e){ee.current&&ee.current.isEqualNode(e.target)&&("Space"!==e.key&&"Enter"!==e.key||(e.preventDefault(),De()))}),[ee,Z]),Se=t.useCallback((function(){oe({type:"focus"})}),[]),Oe=t.useCallback((function(){oe({type:"blur"})}),[]),Re=t.useMemo((function(){return function(e){void 0===e&&(e={});var t=e.onClick,r=void 0===t?function(){}:t,n=e.onDrop,o=void 0===n?function(){}:n,u=e.onDragOver,c=void 0===u?function(){}:u,s=e.onDragLeave,f=void 0===s?function(){}:s,d=e.onKeyDown,p=void 0===d?function(){}:d,v=e.onFocus,g=void 0===v?function(){}:v,m=e.onBlur,y=void 0===m?function(){}:m,h=e.onDragEnter,D=void 0===h?function(){}:h,b=i(e,["onClick","onDrop","onDragOver","onDragLeave","onKeyDown","onFocus","onBlur","onDragEnter"]);return a({onClick:fe(l(r,Fe)),onDrop:de(l(o,Ee)),onDragEnter:de(l(D,Pe)),onDragOver:de(l(c,xe)),onDragLeave:de(l(f,Be)),onKeyDown:Ce(l(p,ke)),onFocus:Ce(l(g,Se)),onBlur:Ce(l(y,Oe))},b)}}),[ee,ke,Se,Oe,Fe,Pe,xe,Be,Ee,K,z,A]),Ae=t.useMemo((function(){return function(e){var t;void 0===e&&(e={});var r=e.refKey,n=void 0===r?"ref":r,o=e.onChange,u=void 0===o?function(){}:o,c=e.onClick,s=void 0===c?function(){}:c,f=i(e,["refKey","onChange","onClick"]),d=((t={accept:h,multiple:U,required:q,type:"file",style:{display:"none"},onChange:fe(l(u,Ee)),onClick:fe(l(s,we)),autoComplete:"off",tabIndex:-1})[n]=Z,t);return a(a({},d),f)}}),[Z,h,Ee,A]),Le=t.useCallback((function(e){Z.current.value="",oe({type:"reset"}),e.stopPropagation()}),[]),Te=t.useMemo((function(){return function(e){void 0===e&&(e={});var t=e.onClick,r=void 0===t?function(){}:t,n=i(e,["onClick"]);return a({onClick:fe(l(r,Le))},n)}}),[Le]);return o.default.createElement(o.default.Fragment,null,o.default.createElement("input",a({},Ae())),r({getRootProps:Re,acceptedFile:ae,ProgressBar:ye,getRemoveFileProps:Te,Remove:he}))};return t.useMemo((function(){return e}),[])}var x={displayProgressBar:"none",progressBarPercentage:0,isDragActive:!1,isFileDialogActive:!1,isFocused:!1,draggedFiles:[],acceptedFiles:[],acceptedFile:null};function B(e,t){switch(t.type){case"openDialog":return a(a({},e),{isFileDialogActive:!0});case"closeDialog":return a(a({},e),{isFileDialogActive:!1});case"setFiles":return a(a({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"setFile":return a(a({},e),{acceptedFile:t.acceptedFile});case"setDisplayProgressBar":return a(a({},e),{displayProgressBar:t.displayProgressBar});case"setProgressBarPercentage":return a(a({},e),{progressBarPercentage:t.progressBarPercentage});case"setDraggedFiles":var r=t.isDragActive,n=t.draggedFiles;return a(a({},e),{draggedFiles:n,isDragActive:r});case"focus":return a(a({},e),{isFocused:!0});case"blur":return a(a({},e),{isFocused:!1});case"reset":return a({},x);default:return e}}var k=n.default.BAD_DELIMITERS,S=n.default.RECORD_SEP,O=n.default.UNIT_SEP,R=n.default.WORKERS_SUPPORTED,A=n.default.LocalChunkSize,L=n.default.DefaultDelimiter;exports.BAD_DELIMITERS=k,exports.DefaultDelimiter=L,exports.LocalChunkSize=A,exports.RECORD_SEP=S,exports.UNIT_SEP=O,exports.WORKERS_SUPPORTED=R,exports.formatFileSize=function(e){var t=1024,r=1048576,n=1073741824;if(e<r){var o=Number((e/t).toFixed(0));return o<=0?e+" B":o+" KB"}return e<n?(e/r).toFixed(0)+" MB":e<1099511627776?(e/n).toFixed(0)+" GB":""},exports.jsonToCSV=b,exports.lightenDarkenColor=function(e,t){var r=!1;"#"==e[0]&&(e=e.slice(1),r=!0);var n=parseInt(e,16),o=(n>>16)+t;o>255?o=255:o<0&&(o=0);var a=(n>>8&255)+t;a>255?a=255:a<0&&(a=0);var i=(255&n)+t;return i>255?i=255:i<0&&(i=0),(r?"#":"")+(i|a<<8|o<<16).toString(16)},exports.readRemoteFile=D,exports.readString=h,exports.useCSVDownloader=function(){var e;return{CSVDownloader:(e=function(e){var t=e.children,r=e.data,a=void 0===r?{}:r,i=e.filename,u=e.type,c=void 0===u?F.Link:u,l=e.style,s=void 0===l?{}:l,f=e.className,d=void 0===f?"":f,p=e.bom,v=void 0!==p&&p,g=e.config,m=void 0===g?{}:g,y=function(){var e=v?"\ufeff":"",t=null,r=null;"function"==typeof a&&(a=a()),t="object"==typeof a?n.default.unparse(a,m):a;var o=new Blob(["".concat(e).concat(t)],{type:"text/csv;charset=utf-8;"}),u=window.navigator;r=u.msSaveBlob?u.msSaveBlob(o,"".concat(i,".csv")):window.URL.createObjectURL(o);var c=document.createElement("a");c.href=r,c.setAttribute("download","".concat(i,".csv")),c.click(),c.remove()};return o.default.createElement(o.default.Fragment,null,c===F.Button?o.default.createElement("button",{onClick:function(){return y()},style:s,className:d},t):o.default.createElement("a",{onClick:function(){return y()},style:s,className:d},t))},o.default.useMemo((function(){return e}),[])),Type:F}},exports.useCSVReader=function(){return{CSVReader:P()}},exports.usePapaParse=function(){return{readString:h,readRemoteFile:D,jsonToCSV:b}};
